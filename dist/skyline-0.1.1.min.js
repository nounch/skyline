var SkyLine=function(){function t(t,e){var a=this;if(Object.prototype.toString.call(e["data"][0])=="[object Array]"){a.dataSet=e["data"]}else{a.dataSet=[e["data"]]}a.allData=[];for(var i=0;i<a.dataSet.length;i++){a.allData=a.allData.concat(a.dataSet[i])}a.minX=d3.min(a.allData,function(t,e){return t[0]});a.maxX=d3.max(a.allData,function(t,e){return t[0]});a.minY=d3.min(a.allData,function(t,e){return t[1]});a.maxY=d3.max(a.allData,function(t,e){return t[1]});a.width=e["width"]||800;a.height=e["height"]||300;a.margin=50;a.knobRadius=e["knobRadius"]||5;a.dataPointsThreshold=e["threshold"]||50;a.noKnobs=!e["knobs"]||false;a.previousCursor=null;a.xScale=d3.scale.linear().domain([a.minX,a.maxX]).range([a.margin,a.width-a.margin]);a.yScale=d3.scale.linear().domain([a.minY,a.maxY]).range([a.height-a.margin,a.margin]);a.svg=d3.select(t).insert("svg:svg",":first-child").attr("width",a.width).attr("height",a.height);a.graph=a.svg.append("svg:g");a.xAxis=d3.svg.axis().orient("bottom").scale(a.xScale).tickSize(5,1).ticks(10);a.xAxisElement=a.svg.append("svg:g").attr("class","line-chart-x-axis").attr("transform","translate(0, "+(a.height-a.margin)+")").call(a.xAxis);a.xAxisElement.selectAll("line").style({stroke:"#121212"});a.yAxis=d3.svg.axis().orient("left").scale(a.yScale).tickSize(5,1).ticks(10);a.yAxisElement=a.svg.append("svg:g").attr("class","line-chart-y-axis").attr("transform","translate("+a.margin+", 0)").call(a.yAxis);a.yAxisElement.selectAll("line").style({stroke:"#121212"});a.xGrid=d3.svg.axis().scale(a.xScale).orient("bottom").tickSize(-(a.height-2*a.margin),0,0).ticks(10);a.graph.append("g").attr("class","axis-without-text").attr("transform","translate(0, "+(a.height-a.margin)+")").call(a.xGrid).style({stroke:"#121212",opacity:"0.1"});d3.selectAll(".axis-without-text .tick text").style({"stroke-width":"0",fill:"none"});a.yGrid=d3.svg.axis().scale(a.yScale).orient("left").tickSize(-(a.width-2*a.margin),0,0).ticks(10);a.graph.append("g").attr("class","axis-without-text").attr("transform","translate( "+a.margin+", 0)").call(a.yGrid).style({stroke:"#121212",opacity:"0.1"});d3.selectAll(".axis-without-text .tick text").style({"stroke-width":"0",fill:"none"});a.tooltip=a.svg.append("svg:text").style({"font-size":"12pt","font-family":"Helvetica"});a.tooltipStyle=e["tooltip"];a.tooltip.style(a.tooltipStyle);a.lineColor=d3.scale.sqrt().domain([0,a.dataSet.length]).range(["steelblue","orange"]).interpolate(d3.interpolateHsl);a.noZoom=!e["zoom"]||false;if(!a.noZoom){a.enableZoom()}a.scatter=e["scatter"]||false}t.prototype=new function(){this.plot=function(){var t=this;if(t.minX<0){t.graph.append("svg:rect").attr("x",t.xScale(0)-.5).attr("y",t.margin).attr("height",t.yScale(t.minY)-t.margin).attr("width",1).style({fill:"#888888"})}if(t.minY<0){t.graph.append("svg:rect").attr("x",t.xScale(t.minX)).attr("y",t.yScale(0)-.5).attr("height",1).attr("width",t.xScale(t.maxX)-t.margin).style({fill:"#888888"})}t.lineStrokeWidth=t.knobRadius/2;t.dataSet.forEach(function(e,a){if(!t.scatter){t.line=d3.svg.line().x(function(e,a){return t.xScale(e[0])}).y(function(e,a){return t.yScale(e[1])});t.path=t.graph.append("svg:path");if(t.allData.length>t.dataPointsThreshold){t.lineStrokeWidth=1}t.path.attr("d",t.line(e)).style({fill:"none",stroke:t.lineColor(a),"stroke-width":t.lineStrokeWidth,"stroke-linejoin":"round","stroke-linecap":"round"}).on("mouseover",function(){t.previousCursor=t.svg.style("cursor");t.svg.style({cursor:"default"});t.moveToForeground(this);d3.select(this).transition().duration(250).style({"stroke-width":t.lineStrokeWidth*2})}).on("mouseleave",function(){t.svg.style({cursor:t.previousCursor});d3.select(this).transition().duration(250).style({"stroke-width":t.lineStrokeWidth})})}this.dataPointIdPrefix="line-chart-data-point-";if(t.allData.length<t.dataPointsThreshold&&!t.noKnobs||t.scatter){var i=t;i.hoverBoxWidth=null;var s=null;if(t.scatter&&t.allData.length>t.dataPointsThreshold){s=2}else{s=i.knobRadius}e.forEach(function(e,o){i.graph.append("svg:circle").attr("cx",i.xScale(e[0])).attr("cy",i.yScale(e[1])).attr("r",s).style({fill:t.lineColor(a)});i.graph.append("svg:circle").attr("cx",t.xScale(e[0])).attr("cy",t.yScale(e[1])).attr("r",t.knobRadius*2).style({fill:t.lineColor(a),opacity:"0.0"}).on("mouseenter",function(){t.previousCursor=t.svg.style("cursor");t.svg.style({cursor:"crosshair"});d3.select(this).style({opacity:"0.3"}).transition().duration(130).attr("r",t.knobRadius*3);t.tooltip.text(e[0]+" | "+e[1]).attr("x",d3.mouse(this)[0]).attr("y",d3.mouse(this)[1]-25).style({visibility:"visible"});t.tooltip.style(t.tooltipStyle)}).on("mouseleave",function(){t.svg.style({cursor:t.previousCursor});d3.select(this).style({opacity:"0.0"}).transition().duration(130).attr("r",t.knobRadius*2);t.tooltip.style({visibility:"hidden"})})})}})};this.moveToForeground=function(t){t.parentNode.appendChild(t)};this.zoomed=function(t){if(d3.event.scale>1){t.graph.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")")}else{t.graph.transition().duration(130).attr("transform","scale("+d3.event.scale+")")}if(d3.event.scale==1){t.zoom.translate([0,0]).scale(1)}t.xAxisElement.transition().duration(130).call(t.xAxis);t.yAxisElement.transition().duration(130).call(t.yAxis)};this.enableZoom=function(){var t=this;t.svg.style({cursor:"ns-resize"});t.zoom=d3.behavior.zoom().x(t.xScale).y(t.yScale).scaleExtent([1,100]).on("zoom",function(){t.previousCursor=t.svg.style("cursor");t.svg.style({cursor:"move"});t.zoomed(t)}).on("zoomend",function(){t.svg.style({cursor:"ns-resize"})});t.svg.call(t.zoom)};this.disableZoom=function(){var t=this;t.svg.style({cursor:"auto"});t.svg.on("mousewheel.zoom",null);t.svg.on("wheel.zoom",null)}};return t}();